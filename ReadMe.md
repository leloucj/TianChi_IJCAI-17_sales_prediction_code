# TianChi_IJCAI-17_sales_prediction   赛后总结和经验

1. 数据清洗非常重要，很大程度上影响了结果的好坏 尤其是对于本次比赛有大量的 0 值，异常值（过高过低），缺失值的状况。对数据进行补全或者修复包括 1.抛弃使用不良且很难补全的数据进行训练 2.对商店缺失的销量使用近期近邻值、往期稳定规律值（从不同时间学习）或者其他相似商户（从不同商家学习）的销量进行融合补全 。
2. 怎么判断异常值？使用同样星期几的方差、差值、每周的方差、余弦相似度等等统计学特征
3. 对于存在这样较多噪声的数据，使用中位数的效果好于平均数
4. 将一周商店的销量换成一周的均值 base 和一周内每天占该周的 ratio 这两类数据进行分别预测效果更好（季军采用方案，自己想到过但是却没有去实现因为觉得如果数据预处理不够好的话异常的数据为导致比重出现很大的偏差）另外在进行模型融合时也可以对 base 和 ratio进行单独融合，取长补短。这么做的好处是将结果的两个独立的影响因素（wave的波形和Base）进行分离，否则模型训练时也容易混淆两个因素导致结果较差。base可以取全局的中值或者其他用规则提取或者分类做函数拟合等等。
5. 双十一对结果的影响很大，但是由于缺乏15年双11的数据（只有小部分商家有而且那个时候才刚刚）所以很难根据先验经验学习。 一个可行的解决方案是将商家做分类（根据地域、类型、档次）然后去做双十一的微调，结合线上结果反馈确立最优值（这么做的结果是最好的，缺点就是需要需要很多次提交不断调节系数，），它的本质是对测试集的拟合，实用意义不大。我采用的是使用15年双十一可用的数据（大概500个）进行训练出双十一boost模型，输入为原模型11.11、11.12的预测值以及商家的info、label为原模型预测值与实际值之差。最后利用这个模型来做16年的双11boost，这么做对结果有一定提升，但是对15年训练数据的清洗要求很高，容易对脏数据过拟合。
6. 我使用的余弦相似度寻找稳定时间段，优点：可以忽略Base大小的影响（因为余弦相似度度量的是向量的方向而不是大小） 缺点（某些店铺在不同时间段会呈现不同的波动状态），此次对成绩提升不大但是是个不错的思路，如果对商家做细致的分类应该会有一些提升
7. 如果要构建base、ratio双模型的话需要数据归一化处理，不过此处并不是为了让个特征梯度下降的速度接近（事实上树模型也不需要这么做），而是为了将数据的 ratio 和 base 进行分离。防止相互之间的干扰。
8. 结合天气进行预测时时不要在原模型加入天气特征而是像做双十一boost一样建立一个label为预测值与实际天气值残差的二次模型，对成绩会有一定的提升。这两个残差模型（预测天气的影响和双十一的）也可以改为 ratio 的残差进行预测～
